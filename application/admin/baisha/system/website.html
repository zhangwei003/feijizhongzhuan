

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>狂神科技|狂神聚合支付 - 网站设置</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="__ADMIN__/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="__ADMIN__/style/admin.css" media="all">
</head>
<body>
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">网站设置</div>
                <div class="layui-card-body" pad15>

                    <div class="layui-form" wid100 lay-filter="">
                        {notempty name='list'}
                        {volist name='list' id='vo'}
                        <div class="layui-form-item">
                            <label class="layui-form-label">{$vo.title}</label>
                            <div class="layui-input-block">
                                {switch name="vo.type"}

                                {case value="0"}
                                <input type="text" name="{$vo.name}" value="{$vo.value}" class="layui-input">
                                {/case}

                                {case value="1"}
                                <input type="text" name="{$vo.name}" value="{$vo.value}" class="layui-input">                                                {/case}
                                {/case}

                                {case value="2"}
                                <textarea class="layui-textarea" name="{$vo.name}" rows="3" placeholder="请输入设置值">{$vo.value}</textarea>
                                {/case}

                                {case value="3"}
                                <select name="{$vo.name}" class="form-control">
                                    {volist name=":parse_config_attr($vo['extra'])" id='vv'}
                                    <option value="{$key}" {eq name="vo.value" value="$key"} selected {/eq} >{$vv}</option>
                                    {/volist}
                                </select>
                                {/case}

                                {case value="4"}
                                <div class="layui-upload">
                                    <button type="button" class="layui-btn" id="test1">上传图片</button>
                                    <div class="layui-upload-list">
                                        <img class="layui-upload-img" {if condition="$vo['value']"}src="{$vo.value}"{/if} width="100px" height="100px" id="demo1">
                                        <input type="hidden" name="logo" id="image_link" value="{$vo.value}" class="layui-input">
                                        <p id="demoText"></p>
                                    </div>
                                </div>
                                {/case}

                                {/switch}
                                {notempty name="vo['describe']"}
                                <div class="layui-form-mid layui-word-aux">（{$vo.describe}）</div>
                                {/notempty}
                            </div>
                        </div>
                        {/volist}
                        {/notempty}
                        <div class="layui-form-item">
                            <div class="layui-input-block">
                                <button class="layui-btn" lay-submit lay-filter="set_website">确认保存</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>

<script src="__ADMIN__/layui/layui.js"></script>
<script>
    layui.config({
        base: '__ADMIN__/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'set']);



    layui.use(['upload','jquery'], function(){
        var upload = layui.upload;
        $= layui.$;
        //执行实例
        var uploadInst = upload.render({
            elem: '#test1' //绑定元素
            ,url: "{:url('system/upload')}" //上传接口
            ,field:'file'
            ,before: function(obj){ //obj参数包含的信息，跟 choose回调完全一致，可参见上文。
                layer.load(); //上传loading
            }
            ,done: function(res){
                layer.closeAll('loading'); //关闭loading
                //上传完毕回调
                // console.log(res)
                layer.msg(res.msg)
                if(res.code ==1 ) {
                    // obj.preview(function(index, file, result){
                    $('#demo1').attr('src', res.data.src); //图片链接（base64）
                    // });
                    $('#image_link').val(res.data.src);
                }
            }
            ,error: function(res){
                layer.closeAll('loading'); //关闭loading
                //请求异常回调
                console.log('123')
                if(res.code > 0){
                    return layer.msg('上传失败');
                }
            }
        });
    });
</script>
</body>
</html>
